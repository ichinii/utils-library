#!/bin/bash

. req "$editor"
. req "tree"
. req "find"
. req "completer"

usage="Usage:\tcb -l\n\tcb -r [file/directory]\n\tcb -d [dirname]\n\tcb [file]\n\tcb -m [file/directory] [target-position]\n\tcb -c [file/directory] [target-position]"

if [ -n "$1" ]; then
	if [ "$1" == "--help" ]; then
		echo -e "$usage"
	fi

	if [ ! -d "$ul_tmpdir/cb" ]; then
		mkdir "$ul_tmpdir/cb"
	fi

	if [ "$1" == "-l" ]; then
		tree "$ul_tmpdir/cb"
	elif [ "$1" == "-r" ]; then
		if [ -n "$2" ]; then
			if [ -e "$ul_tmpdir/cb/$2" ]; then
				rm -r "$ul_tmpdir/cb/$2"
			else
				echo "Can't find file $ul_tmpdir/cb/$2"
			fi
		else
			echo -e "$usage"
		fi
	elif [ "$1" == "-d" ]; then
		if [ -n "$2" ]; then
			mkdir "$ul_tmpdir/cb/$2"
		fi
	elif [ "$1" == "-m" ]; then
		if [ -n "$3" ]; then
			if [ -e "$ul_tmpdir/cb/$2" ]; then
				mv "$ul_tmpdir/cb/$2" "$ul_tmpdir/cb/$3"
			else
				echo "$ul_tmpdir/cb/$2 doesn't exist"
			fi
		else
			echo -e "$usage"
		fi
	
	elif [ "$1" == "-c" ]; then
		if [ -n "$3" ]; then
			if [ -e "$ul_tmpdir/cb/$2" ]; then
				cp -r "$ul_tmpdir/cb/$2" "$ul_tmpdir/cb/$3"
			else
				echo "$ul_tmpdir/cb/$2 doesn't exist"
			fi
		else
			echo -e "$usage"
		fi
	else
		$editor $ul_tmpdir/cb/"$1"
	fi
else
	echo -e "$usage"
fi
